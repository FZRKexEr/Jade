# 安装指南

本文档详细介绍如何安装和配置中国象棋 macOS 应用。

## 目录

- [系统要求](#系统要求)
- [下载安装包](#下载安装包)
- [安装应用](#安装应用)
- [首次启动配置](#首次启动配置)
- [引擎配置](#引擎配置)
- [常见问题](#常见问题)

## 系统要求

### 最低要求

| 项目 | 要求 |
|------|------|
| 操作系统 | macOS 14.0 (Sonoma) 或更高版本 |
| 处理器 | Apple Silicon (M1/M2/M3) 或 Intel 芯片 |
| 内存 | 4 GB RAM |
| 磁盘空间 | 200 MB（不包括引擎文件） |
| 网络 | 仅下载时需要 |

### 推荐配置

| 项目 | 推荐配置 |
|------|----------|
| 操作系统 | macOS 14.5+ 或 macOS 15 (Sequoia) |
| 处理器 | Apple Silicon (M3/M3 Pro/Max) |
| 内存 | 8 GB RAM 或更高 |
| 磁盘空间 | 500 MB（包含多个引擎） |

## 下载安装包

### 从 GitHub Releases 下载

1. 访问项目的 [Releases](../../releases) 页面
2. 下载最新版本的 `.dmg` 文件，例如 `ChineseChess-1.0.0.dmg`
3. 等待下载完成

<!-- TODO: Screenshot - GitHub Releases 页面截图 -->

### 验证下载

下载完成后，建议验证文件完整性：

```bash
# 计算 SHA256 校验和
shasum -a 256 ChineseChess-1.0.0.dmg

# 与 releases 页面提供的校验和对比
```

## 安装应用

### 标准安装步骤

1. **打开 DMG 文件**
   - 双击下载的 `.dmg` 文件
   - 系统会自动挂载磁盘镜像

<!-- TODO: Screenshot - DMG 挂载窗口截图 -->

2. **拖拽安装**
   - 将应用图标拖拽到 Applications 文件夹
   - 或者拖拽到你喜欢安装的位置

3. **弹出磁盘镜像**
   - 安装完成后，右键点击桌面上的磁盘图标
   - 选择"推出"以卸载 DMG

### 首次启动安全设置

由于应用不是从 Mac App Store 下载的，首次启动时需要进行额外设置：

#### 方法一：通过系统偏好设置（推荐）

1. 首次尝试打开应用时，会弹出警告：
   > "ChineseChess" 无法打开，因为无法验证开发者。

2. 点击"取消"

3. 打开 **系统设置** > **隐私与安全性**

4. 在"安全性"部分，找到关于该应用的警告消息

5. 点击"仍要打开"

<!-- TODO: Screenshot - 隐私与安全性设置截图 -->

6. 再次点击"打开"确认

#### 方法二：通过右键菜单

1. 在 Applications 文件夹中找到应用
2. 按住 **Control** 键并点击应用图标
3. 选择"打开"
4. 在弹出的警告对话框中点击"打开"

#### 方法三：使用命令行（高级）

```bash
# 移除应用的隔离属性
xattr -d com.apple.quarantine /Applications/ChineseChess.app

# 然后正常打开应用
open /Applications/ChineseChess.app
```

## 首次启动配置

### 欢迎界面

首次启动应用时，会显示欢迎界面：

<!-- TODO: Screenshot - 欢迎界面截图 -->

1. **语言选择**：选择界面语言（当前支持中文和英文）
2. **主题选择**：选择浅色或深色主题
3. **棋盘样式**：选择喜欢的棋盘外观

### 棋盘样式设置

在 **视图** > **棋盘样式** 中可以更改：

- **传统风格**：经典中式棋盘
- **现代风格**：简洁现代设计
- **木纹风格**：仿木材质感

<!-- TODO: Screenshot - 不同棋盘样式对比截图 -->

## 引擎配置

### 支持的引擎

应用支持所有符合 UCI 协议的中国象棋引擎：

| 引擎 | 描述 | 推荐程度 |
|------|------|----------|
| [Pikafish](https://github.com/official-pikafish/Pikafish) | 最强的开源中国象棋引擎 | ⭐⭐⭐⭐⭐ |
| [Fairy-Stockfish](https://github.com/fairy-stockfish/Fairy-Stockfish) | 支持多种象棋变体 | ⭐⭐⭐⭐ |

### 下载 Pikafish 引擎

#### 方法一：通过应用自动下载（推荐）

1. 打开应用，进入 **引擎** > **引擎管理**
2. 点击"下载 Pikafish"按钮
3. 选择适合的版本：
   - **Apple Silicon 版本**: 适用于 M1/M2/M3 Mac
   - **Intel 版本**: 适用于 Intel Mac
4. 等待下载和自动配置完成

<!-- TODO: Screenshot - 引擎下载界面截图 -->

#### 方法二：手动下载

1. 访问 [Pikafish Releases](https://github.com/official-pikafish/Pikafish/releases)
2. 下载适用于 macOS 的版本
3. 解压下载的文件
4. 在应用中选择 **引擎** > **配置引擎** > **添加引擎**
5. 选择解压后的引擎可执行文件

### 配置引擎选项

连接引擎后，可以在 **引擎** > **引擎选项** 中配置：

| 选项 | 说明 | 建议值 |
|------|------|--------|
| Hash | 引擎使用的内存大小（MB） | 256-1024 |
| Threads | 使用的 CPU 线程数 | 2-4 |
| Skill Level | 引擎强度等级（0-20） | 20（最强）|
| UCI_Variant | 象棋变体 | xiangqi |

<!-- TODO: Screenshot - 引擎选项设置截图 -->

### 多引擎配置

应用支持配置多个引擎：

1. 打开 **引擎** > **引擎管理**
2. 点击"添加引擎"按钮
3. 选择引擎可执行文件
4. 为引擎命名（如"Pikafish-Strong"、"Pikafish-Weak"）
5. 配置不同的强度等级

## 常见问题

### 无法启动应用

**问题**: 双击应用后没有任何反应

**解决方案**:
1. 检查系统版本是否满足 macOS 14+ 要求
2. 查看控制台日志（控制台.app）查找错误信息
3. 尝试通过终端启动查看错误输出：
   ```bash
   /Applications/ChineseChess.app/Contents/MacOS/ChineseChess
   ```

### 引擎连接失败

**问题**: 连接引擎时显示"引擎连接失败"

**解决方案**:
1. 确认引擎文件存在且具有可执行权限：
   ```bash
   chmod +x /path/to/engine
   ```
2. 检查引擎是否为兼容架构（Apple Silicon 或 Intel）
3. 尝试从终端手动运行引擎查看错误
4. 查看应用日志获取详细错误信息

### 应用运行缓慢

**问题**: 棋盘操作卡顿或引擎分析缓慢

**解决方案**:
1. **降低引擎强度**: 减少 Threads 和 Hash 设置
2. **关闭分析模式**: 不使用时关闭实时分析
3. **增加内存分配**: 在引擎选项中增加 Hash 大小
4. **关闭其他应用**: 释放系统资源

### 棋盘显示异常

**问题**: 棋子显示错位或棋盘渲染异常

**解决方案**:
1. 尝试切换棋盘样式（视图 > 棋盘样式）
2. 重启应用
3. 检查系统显示设置（分辨率、缩放）
4. 重置窗口布局（窗口 > 重置布局）

### 保存的棋谱无法打开

**问题**: 之前保存的棋谱文件无法加载

**解决方案**:
1. 确认文件扩展名为 `.pgn` 或 `.xiangqi`
2. 检查文件内容格式是否正确（PGN 格式）
3. 尝试用文本编辑器打开文件验证内容
4. 检查文件权限

### 提示功能不可用

**问题**: 点击"提示"按钮没有反应

**解决方案**:
1. 确认引擎已正确连接（引擎菜单 > 显示引擎状态）
2. 检查是否是用户的回合（提示只在玩家回合有效）
3. 确认不是终局状态
4. 重新连接引擎

## 获取帮助

如果以上方法无法解决你的问题，可以通过以下方式获取帮助：

1. **查看文档**: 阅读完整的 [用户手册](UserGuide.md)
2. **提交 Issue**: 在 [GitHub Issues](../../issues) 报告问题
3. **查看日志**: 在应用菜单 **帮助 > 查看日志** 获取诊断信息

---

**提示**: 保持应用更新到最新版本可以获得最佳体验并修复已知问题。
